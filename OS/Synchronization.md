# 동기화 (Synchronization)

프로세스나 스레드가 동시에 실행될 때 공유 자원에 대한 접근을 올바르게 제어하여 데이터의 일관성과 정확성을 보장하는 기법

---

## 공유 자원과 임계 구역

### 공유 자원 (Shared Resource)

여러 스레드나 프로세스가 공동으로 접근할 수 있는 변수, 파일, 메모리 공간, 데이터베이스 등의 자원
공유 자원은 동시에 여러 곳에서 접근할 경우 데이터 불일치가 발생할 수 있다.

ex)
두 스레드가 동시에 하나의 전역 변수 `count`를 증가시키면 결과적으로 `count`가 한 번만 증가하는 문제가 발생 가능

### 임계 구역 (Critical Section)

공유 자원에 접근하는 코드 중 동시에 실행했을 때 문제가 발생할 수 있는 코드

---

## 레이스 컨디션 (Race Condition)

프로세스 혹은 스레드가 동시에 임계 구역의 코드를 실행하여 문제가 발생하는 상황

ex)

1. 스레드 A가 balance 값을 읽음 (100)  
2. 스레드 B가 balance 값을 읽음 (100)  
3. 스레드 A가 10원을 더해 110을 저장  
4. 스레드 B가 10원을 더해 110을 다시 저장  

---

## 동기화 기법

### 뮤텍스 락 (Mutex Lock)

동시에 접근해서는 안되는 자원에 동시 접근이 불가능하도록 상호 배제를 보장하는 동기화 도구
임계 구역에 접근하려면 반드시 락을 획득해야하고 임계 구역에서의 작업이 끝났다면 락을 해제
- 한 스레드가 임계 구역에 들어갈 때 acquire()로 락을 획득
- 다른 스레드는 잠금이 해제될 때까지 대기

---

### 세마포 (Semaphore)

허용 가능한 최대 접근 스레드 수를 정해 동시에 여러 스레드가 접근할 수 있도록 제어

#### 구성 요소
- `wait()`: 세마포 값(S)을 1 감소시키며, 0보다 작아지면 대기 상태로 전환  
- `signal()`: 세마포 값(S)을 1 증가시키며, 대기 중인 스레드를 깨움
  
---

### 조건 변수와 모니터 (Condition Variable & Monitor)

#### 조건 변수 (Condition Variable)

스레드가 특정 조건을 만족할 때까지 대기  
조건이 충족되면 **다른 스레드가 신호를 보내** 실행을 재개하게 하는 동기화 도구이다.

- `wait()`: 특정 프로세스가 실행할 조건이 되지 않았을 때 호출하여 실행 중단
- `signal()`: 특정 프로세스가 실행할 조건이 충족되었을 때 호출하여 실행 재개


#### 모니터 (Monitor)

공유 자원과 그 공유 자원을 다루는 함수로 구성된 동기화 도구
상호 배제를 위한 동기화 + 실행 순서 제어를 위한 동기화 가능

프로세스 및 스레드는 공유 자원에 접근하기 위해 반드시 정해진 공유 자원 연산을 통해 모니터 내로 진입
모니터 안에 진입하여 실행되는 프로세스 및 스레드는 항상 하나여야한다.(이미 모니터 내에 진입한 프로세스 및 스레드가 있을 경우 큐에서 대기)
